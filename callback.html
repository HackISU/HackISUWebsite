<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="./images/hackisu/2018/Spring/HackSquirrel_Spring2018.png">

    <title>HackISU - Callback</title>

    <!-- Bootstrap Core CSS v4 Beta 2-->
    <link href="./css/bootstrap/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts and icons -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./css/mainStyle.css">
    <link rel="stylesheet" href="./css/backgroundAnimation.css">

    <style>
        h1, h2, h3, h4, h5{
            color: white;
            text-shadow: -1px 0 black, 0 2px black, 1px 0 black, 0 -1px black;
        }
    </style>
</head>

<body>
    <div class="container text-center">
        <div class="row">
            <div class="col-md-12">
                <img src="./images/hackisu/2018/Spring/HackSquirrel_Spring2018.png" style="width: 25%" alt="HackISU Squirrel">
            </div>
        </div>

        <div class="row">
            <div class="offset-md-2 col-md-8">
                <h3>You've almost reqistered for Spring 2018 HackISU!</h3>
                <p>By registering for this event, you are agreeing to follow the
                    <a href="https://static.mlh.io/docs/mlh-code-of-conduct.pdf" target="_blank" class="fontBorder fontBorderLink">MLH Code of Conduct.</a>
                    We want HackISU to be a safe space for everyone, and the Code of Conduct helps accomplish that goal.</p>
            </div>
        </div>

        <div class="row">
            <div class="offset-md-2 col-md-8">
                <h4 class="">You're registering with the following information:</h4>
                <table class="table">
                    <tbody>
                        <tr>
                            <td>Name</td>
                            <td id="name"></td>
                        </tr>
                        <tr>
                            <td>School</td>
                            <td id="school"></td>
                        </tr>
                        <tr>
                            <td>Major</td>
                            <td id="major"></td>
                        </tr>
                        <tr>
                            <td>Email</td>
                            <td id="email"></td>
                        </tr>
                        <tr>
                            <td>Shirt Size</td>
                            <td id="shirt"></td>
                        </tr>
                    </tbody>
                </table>

                <p><input type="checkbox"> I agree to the terms of both the
                    <a href="https://github.com/MLH/mlh-policies/tree/master/prize-terms-and-conditions" class="fontBorder fontBorderLink">MLH Contest Terms and Conditions</a>
                    and the <a href="https://mlh.io/privacy" class="fontBorder fontBorderLink">MLH Privacy Policy</a>. 
                    Please note that you may receive pre and post-event informational e-mails and occasional messages about hackathons from MLH as per the MLH Privacy Policy.</p>
            </div>
        </div>

        <div class="row">
            <div class="offset-md-2 col-md-8">
                <h4>Now's the time for some links we can share with our sponsors, they're optional:</h4>
            </div>
        </div>

        <div class="">
            <div class="offset-md-3 col-md-6">
                <form class="form">
                    <div class="form-group">
                        <label for="fileselect" class="h5">Resume:</label>
                        <input type="email" class="form-control w-100" name="fileselect" id="fileselect" placeholder="https://"></input>
                    </div>
                    <div class="form-group">
                        <label for="github" class="h5">Github:</label>
                        <input type="email" class="form-control w-100" name="github" id="github" placeholder="https://github.com/">
                    </div>
                    <div class="form-group">
                        <div onclick="postData()" class="btn btn-xl" role="button">Submit</div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Bootstrap core JavaScript ========================================= -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- jquery.js, then popper.js, then bootstrap.js -->
    <!-- <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="./js/bootstrap/jquery.min.js"><\/script>')</script> -->
    <script src="./js/bootstrap/jquery-3.2.1.js"></script>
    <script src="./js/bootstrap/popper.min.js"></script>
    <script src="./js/bootstrap/bootstrap.min.js"></script>

    <!-- <script src="./js/callback.js"></script> -->

    <script>
        $(document).ready(function () {
            getData();
        });
        var postData = function postData() {

            var resume = $("#fileselect").val();
            var github = $("#github").val();
            addData({
                resume: resume,
                github: github
            });
        }

        var addData = function addData(data) {
            var token = getUrlParameter("access_token");
            var strung = JSON.stringify({
                token: token,
                resume: data.resume,
                github: data.github
            })
            $.ajax({
                type: "POST",
                url: "https://hackisu-spring2018.herokuapp.com/user",
                data: strung,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    window.location.assign("https://hackisu.org/success.html");
                }
            });
        }

        var getData = function getData() {
            var token = getUrlParameter('access_token');

            $.get("https://my.mlh.io/api/v2/user?access_token=" + token, function (data) {
                var info = data.data;
                console.log(info);
                $('#name').text(info.first_name + ' ' + info.last_name);
                $('#school').text(info.school.name);
                $('#major').text(info.major);
                $('#email').text(info.email);
                $('#shirt').text(info.shirt_size);
            });
        }

        var getUrlParameter = function getUrlParameter(sParam) {
            var sPageURL = decodeURIComponent(window.location.href.split("#")[1]),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : sParameterName[1];
                }
            }
        };
    </script>
</body>